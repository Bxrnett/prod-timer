<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productivity Timer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Landing Page -->
    <div class="page active" id="landingPage">
        <div class="landing-container">
            <div class="landing-content">
                <div class="landing-icon">ğŸš€</div>
                <h1 class="landing-title">Welcome to Your Productivity Zone</h1>
                <p class="landing-subtitle">Let's make every minute count together!</p>
                
                <div class="name-input-section">
                    <label for="nameInput" class="name-label">What should we call you?</label>
                    <input 
                        type="text" 
                        id="nameInput" 
                        class="name-input"
                        placeholder="Enter your name..." 
                        onkeypress="handleNameInputKeypress(event)"
                        autofocus
                    />
                    <button class="btn-primary btn-large" onclick="saveName()">Let's Get Started! ğŸ¯</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="nav-bar" id="mainNav" style="display: none;">
        <button class="nav-btn active" id="timerNavBtn" onclick="showPage('timer')">â±ï¸ Timer</button>
        <button class="nav-btn" id="tasksNavBtn" onclick="showPage('tasks')">ğŸ“ Tasks</button>
        <button class="nav-btn" id="profileBtn" onclick="editName()">ğŸ‘¤ <span id="navUserName"></span></button>
    </nav>

    <!-- Timer Page -->
    <div class="page" id="timerPage">
        <div class="container">
            <h1 id="timerPageTitle">Productivity Timer</h1>
            <p class="welcome-message" id="welcomeMessage"></p>
            
            <div class="timer-section">
                <div class="timer-label">
                    <span class="status-badge" id="statusBadge">Ready to Dial-In</span>
                </div>
                
                <!-- Coffee Cup Visualization -->
                <div class="coffee-container">
                    <div class="coffee-cup">
                        <div class="coffee-liquid" id="coffeeLiquid"></div>
                        <div class="coffee-handle"></div>
                    </div>
                </div>
                
                <div class="timer-display" id="timerDisplay">25:00</div>
                
                <div class="session-info">
                    <div>Session: <strong id="sessionCount">1/4</strong></div>
                    <div>Session completed: <strong id="pomodoroCount">0</strong></div>
                </div>

                <div class="current-task" id="currentTaskDisplay">
                    No task selected
                </div>

                <div class="button-group">
                    <button class="btn-primary" id="startBtn" onclick="startTimer()">Start</button>
                    <button class="btn-secondary" id="pauseBtn" onclick="pauseTimer()" disabled>Pause</button>
                    <button class="btn-danger" id="resetBtn" onclick="resetTimer()">Reset</button>
                </div>

                <div class="page-hint">
                    ğŸ’¡ Go to Tasks page to select or add tasks
                </div>
            </div>
        </div>
    </div>

    <!-- Tasks Page -->
    <div class="page" id="tasksPage">
        <div class="container">
            <h1 id="tasksPageTitle">ğŸ“ Task List</h1>
            <p class="welcome-message" id="tasksWelcomeMessage"></p>
            
            <div class="task-input-group">
                <input 
                    type="text" 
                    id="taskInput" 
                    placeholder="Enter a new task..." 
                    onkeypress="handleTaskInputKeypress(event)"
                />
                <button class="btn-primary" onclick="addTask()">Add Task</button>
            </div>

            <ul class="task-list" id="taskList">
                <li class="empty-state">No tasks yet. Add one above!</li>
            </ul>

            <div class="page-hint" id="taskPageHint" style="display: none;">
                âœ… Task selected! Go to Timer page to start working
            </div>
        </div>
    </div>

    <script>
        // User data
        let userName = localStorage.getItem('productivityTimerUserName') || '';

        // Page navigation
        let currentPage = 'landing';

        function showPage(pageName) {
            currentPage = pageName;
            
            // Update pages
            document.getElementById('landingPage').classList.toggle('active', pageName === 'landing');
            document.getElementById('timerPage').classList.toggle('active', pageName === 'timer');
            document.getElementById('tasksPage').classList.toggle('active', pageName === 'tasks');
            
            // Update nav buttons
            document.getElementById('timerNavBtn').classList.toggle('active', pageName === 'timer');
            document.getElementById('tasksNavBtn').classList.toggle('active', pageName === 'tasks');
            document.getElementById('profileBtn').classList.toggle('active', false);
        }

        function saveName() {
            const input = document.getElementById('nameInput');
            const name = input.value.trim();
            
            if (!name) {
                alert('Please enter your name to continue!');
                return;
            }
            
            userName = name;
            localStorage.setItem('productivityTimerUserName', userName);
            
            // Show main app
            document.getElementById('mainNav').style.display = 'flex';
            updatePersonalization();
            showPage('timer');
        }

        function handleNameInputKeypress(event) {
            if (event.key === 'Enter') {
                saveName();
            }
        }

        function editName() {
            const newName = prompt('Enter your new name:', userName);
            if (newName && newName.trim()) {
                userName = newName.trim();
                localStorage.setItem('productivityTimerUserName', userName);
                updatePersonalization();
            }
        }

        function updatePersonalization() {
            const greetings = [
                `Hey ${userName}! Ready to crush it?`,
                `Welcome back, ${userName}! Let's be productive!`,
                `Hi ${userName}, time to focus!`,
                `${userName}, you've got this! ğŸ’ª`,
                `Great to see you, ${userName}!`
            ];
            
            const greeting = greetings[Math.floor(Math.random() * greetings.length)];
            
            // Update all personalized elements
            document.getElementById('navUserName').textContent = userName;
            document.getElementById('timerPageTitle').textContent = `${userName}'s Productivity Timer`;
            document.getElementById('welcomeMessage').textContent = greeting;
            document.getElementById('tasksPageTitle').textContent = `${userName}'s Tasks`;
            document.getElementById('tasksWelcomeMessage').textContent = `Organize your work, ${userName}!`;
        }

        function checkUserStatus() {
            if (userName) {
                document.getElementById('mainNav').style.display = 'flex';
                updatePersonalization();
                showPage('timer');
            } else {
                showPage('landing');
            }
        }

        // Time settings
        let timeLeft = 25 * 60; // 25 minutes in seconds
        let timerInterval = null;
        let isRunning = false;
        let currentSession = 1;
        let totalPomodoros = 0;
        let timerMode = 'focus'; // 'focus', 'rest', 'break'

        // Task status
        let tasks = [];
        let selectedTaskId = null;

        // Timer functions
        function updateDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timerDisplay').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            document.getElementById('sessionCount').textContent = `${currentSession}/4`;
            document.getElementById('pomodoroCount').textContent = totalPomodoros;
            
            updateCoffeeLiquid();
            updateStatusBadge();
        }
        
        function updateCoffeeLiquid() {
            const totalTime = timerMode === 'focus' ? 25 * 60 : (timerMode === 'rest' ? 5 * 60 : 15 * 60);
            const percentage = (timeLeft / totalTime) * 100;
            const coffeeLiquid = document.getElementById('coffeeLiquid');
            coffeeLiquid.style.height = percentage + '%';
        }

        function updateStatusBadge() {
            const badge = document.getElementById('statusBadge');
            if (!isRunning) {
                badge.textContent = 'Ready to Dial-In';
                badge.className = 'status-badge status-focus';
                return;
            }

            if (timerMode === 'focus') {
                badge.textContent = 'ğŸ¯ Focus Time';
                badge.className = 'status-badge status-focus';
            } else if (timerMode === 'rest') {
                badge.textContent = 'â˜• Short Break';
                badge.className = 'status-badge status-rest';
            } else if (timerMode === 'break') {
                badge.textContent = 'ğŸŒ´ Long Break';
                badge.className = 'status-badge status-break';
            }
        }

        function startTimer() {
            if (!selectedTaskId) {
                alert('Please select a task before starting the timer!');
                return;
            }

            isRunning = true;
            document.getElementById('startBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateDisplay();
                
                if (timeLeft <= 0) {
                    handleTimerComplete();
                }
            }, 1000);
        }

        function pauseTimer() {
            isRunning = false;
            clearInterval(timerInterval);
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            updateStatusBadge();
        }

        function resetTimer() {
            pauseTimer();
            currentSession = 1;
            totalPomodoros = 0;
            timerMode = 'focus';
            timeLeft = 25 * 60;
            updateDisplay();
        }

        function handleTimerComplete() {
            pauseTimer();
            playNotificationSound();
            
            if (timerMode === 'focus') {
                totalPomodoros++;
                
                if (currentSession === 4) {
                    // Long break after 4 sessions
                    alert('ğŸ‰ You smashed that! Time for a 15-minute break!');
                    timerMode = 'break';
                    timeLeft = 15 * 60;
                    currentSession = 1;
                } else {
                    // Short break
                    alert('âœ… You smashed that! Take a 5-minute break.');
                    timerMode = 'rest';
                    timeLeft = 5 * 60;
                    currentSession++;
                }
            } else {
                // Break is over, back to focus
                alert('Break time is over! Ready for the next Dial-In session?');
                timerMode = 'focus';
                timeLeft = 25 * 60;
            }
            
            updateDisplay();
        }

        function playNotificationSound() {
            // Create a simple beep sound
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        // Task functions
        function addTask() {
            const input = document.getElementById('taskInput');
            const taskText = input.value.trim();
            
            if (!taskText) {
                alert('Please enter a task!');
                return;
            }
            
            const task = {
                id: Date.now(),
                text: taskText
            };
            
            tasks.push(task);
            input.value = '';
            renderTasks();
        }

        function deleteTask(taskId) {
            tasks = tasks.filter(t => t.id !== taskId);
            if (selectedTaskId === taskId) {
                selectedTaskId = null;
                updateCurrentTaskDisplay();
                updateTaskPageHint();
            }
            renderTasks();
        }

        function completeTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                alert(`ğŸ‰ Congratulations, ${userName}! You completed: "${task.text}"\n\nYou're smashing it!`);
            }
            tasks = tasks.filter(t => t.id !== taskId);
            if (selectedTaskId === taskId) {
                selectedTaskId = null;
                updateCurrentTaskDisplay();
                updateTaskPageHint();
            }
            renderTasks();
        }

        function selectTask(taskId) {
            // Toggle selection: if clicking the already selected task, deselect it
            if (selectedTaskId === taskId) {
                selectedTaskId = null;
            } else {
                selectedTaskId = taskId;
            }
            renderTasks();
            updateCurrentTaskDisplay();
            updateTaskPageHint();
        }

        function updateTaskPageHint() {
            const hint = document.getElementById('taskPageHint');
            if (hint) {
                hint.style.display = selectedTaskId ? 'block' : 'none';
            }
        }

        function updateCurrentTaskDisplay() {
            const display = document.getElementById('currentTaskDisplay');
            if (selectedTaskId) {
                const task = tasks.find(t => t.id === selectedTaskId);
                display.textContent = `Working on: ${task.text}`;
            } else {
                display.textContent = 'No task selected';
            }
        }

        function renderTasks() {
            const taskList = document.getElementById('taskList');
            
            if (tasks.length === 0) {
                taskList.innerHTML = '<li class="empty-state">No tasks yet. Add one above!</li>';
                updateTaskPageHint();
                return;
            }
            
            taskList.innerHTML = tasks.map(task => `
                <li class="task-item ${selectedTaskId === task.id ? 'selected' : ''}">
                    <input 
                        type="radio" 
                        name="task" 
                        ${selectedTaskId === task.id ? 'checked' : ''}
                        onchange="selectTask(${task.id})"
                    />
                    <span class="task-text" onclick="selectTask(${task.id})">${task.text}</span>
                    <button class="complete-btn" onclick="completeTask(${task.id})">âœ“ Complete</button>
                    <button class="delete-btn" onclick="deleteTask(${task.id})">Delete</button>
                </li>
            `).join('');
            
            updateCurrentTaskDisplay();
            updateTaskPageHint();
        }

        function handleTaskInputKeypress(event) {
            if (event.key === 'Enter') {
                addTask();
            }
        }

        // Initialize display
        updateDisplay();
        checkUserStatus();
    </script>
</body>
</html>